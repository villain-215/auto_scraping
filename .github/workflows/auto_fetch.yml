name: i-dle News Auto Fetch

on:
  schedule:
    - cron: '0 1 * * *' # 每天國際標準時間 01:00 (台灣時間早上 9:00) 跑一次
  workflow_dispatch: # 讓你可以手動點擊按鈕執行

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: 檢出代碼
        uses: actions/checkout@v3

      - name: 設定 Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: 安裝套件
        run: |
          pip install requests beautifulsoup4 lxml

      - name: 執行抓取腳本
        run: |
          python database.py # 記得改成你抓取檔案的檔名
          ls -lh  # 這是「監視器」：列出檔案大小，讓你在 Log 裡直接看到 db 有多大

      - name: 將資料庫更新推回倉庫
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add idle_data.db
          git commit -m "Auto updated i-dle news" || exit 0
          git push